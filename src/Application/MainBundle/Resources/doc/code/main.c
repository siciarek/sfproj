#include <stdio.h>
#include <stdlib.h>

double x[] = {
    0.000000000000, 
    0.330693963536, 
    0.661387927072, 
    0.992081890607, 
    1.322775854143, 
    1.653469817679, 
    1.984163781215, 
    2.314857744750, 
    2.645551708286, 
    2.976245671822, 
    3.306939635358, 
    3.637633598893, 
    3.968327562429, 
    4.299021525965, 
    4.629715489501, 
    4.960409453037, 
    5.291103416572, 
    5.621797380108, 
    5.952491343644, 
    6.283185307180
};

double y[] = {
    0.000000000000,
    0.324699469205,
    0.614212712690,
    0.837166478263,
    0.969400265939,
    0.996584493007,
    0.915773326655,
    0.735723910673,
    0.475947393037,
    0.164594590281,
    -0.164594590281,
    -0.475947393037,
    -0.735723910673,
    -0.915773326655,
    -0.996584493007,
    -0.969400265939,
    -0.837166478263,
    -0.614212712690,
    -0.324699469205,
    -0.000000000000
};

double a[] = {
    0.000000000003,
    -0.569230686397,
    0.000000000005,
    0.666916672377,
    0.000000000003,
    -0.104282368749,
    0.000000000001,
    0.006840633539,
    -0.000000000001,
    -0.000250006869,
    -0.000000000003,
    0.000005850271,
    -0.000000000003,
    -0.000000095327,
    -0.000000000003,
    0.000000001159,
    -0.000000000001,
    -0.000000000005,
    -0.000000000000,
    0.000000000001
};

/**
 * Granice interpolowanego przedziału
 */
double range[] = {0.000000000000, 6.283185307180};

/**
 * Funkcja przeliczająca wartość z przedziału [a, b] na odpowiednią
 * wartość z przedziału [-1, 1]
 */
double norm(double x, double a, double b) {
    return (x - 0.5 * (a + b)) * (2 / (b - a));
}

/**
 * Wielomian bazy Czebyszewa
 */
double T(unsigned int k, double x) {

   switch(k) {
       case 0:
           return 1;
       case 1:
           return x;
   }

   return 2 * x * T(k - 1, x) - T(k - 2, x);
}

/**
 * Wielomian interpolacyjny Czebyszewa
 */
double W(double x, double a[]) {
   int k = 0;
   double sum = 0.0;

   x = norm(x, range[0], range[1]);

   for(k = 0; k < 20; k++) {
       sum += a[k] * T(k, x);
   }

   return sum;
}

double sin(double x) {
    return W(x, a);
}

int main(int argc, char** argv) {
    
    int i = 0;
    
    for(i = 0; i < 20; i++) {
        double err = sin(x[i]) - y[i];
        printf("%.12f,%.12f,%.12f,%.12f\n", x[i], sin(x[i]), y[i], err);
    }
    
    return EXIT_SUCCESS;
}
